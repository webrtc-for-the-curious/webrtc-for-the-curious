<!doctype html><html lang=ja dir=ltr><head><meta charset=UTF-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="リアルタイム・ネットワーキング # リアルタイム・コミュニケーションにおいて、なぜネットワークが重要なのか？ # ネットワークは、リアルタイム通信を制限する要素です。理想的な世界では、帯域幅が無限にあり、パケットは瞬時に到着します。しかし、実際にはそうではありません。ネットワークには限界があり、いつでも条件が変わる可能性があります。また、ネットワークの状態を測定・観察することも難しい問題です。ハードウェア、ソフトウェア、そしてその構成によって、さまざまな挙動を示すことがあります。
また、リアルタイムでの通信は、他の領域にはない問題です。Web制作者にとっては、ネットワークによってはWebサイトの表示が遅くなっても致命的ではありません。すべてのデータが届いていれば、ユーザーは満足です。WebRTCでは、データが遅れれば意味がありません。5秒前の電話会議の内容なんて誰も気にしません。そのため、リアルタイム通信システムを開発する際には、トレードオフの関係にならざるを得ません。制限時間は何秒か、どれだけ送れるか。
本章では、データ通信とメディア通信の両方に適用される概念を説明します。後の章では、理論的な説明にとどまらず、WebRTCのメディアサブシステムとデータサブシステムがこれらの問題をどのように解決するのかを説明します。
難しくしているネットワークの属性は何ですか？ # すべてのネットワークで効果的に機能するコードは複雑です。多くの異なる要因があり、それらがすべて微妙に影響し合います。開発者が遭遇する最も一般的な問題は以下の通りです。
帯域幅 # 帯域幅とは、特定のパスで転送できるデータの最大レートのことです。これは固定された数値ではないことを覚えておく必要があります。帯域幅は、利用者の増加（または減少）に伴い、経路に沿って変化します。
送信時間とラウンドトリップタイム # 送信時間とは、パケットが到着するまでの時間のことです。帯域幅と同様、これも一定ではありません。 送信時間は、いつでも変動する可能性があります。
伝送時間を計算するには、送信側と受信側の時計がミリ秒単位で同期している必要があります。 少しでもずれがあると、信頼性の低い伝送時間の測定になってしまいます。 WebRTCは非常に異質な環境で運用されているため、ホスト間の完全な時刻同期に頼ることはほとんど不可能です。
ラウンドトリップタイムの測定は、不完全なクロック同期の回避策です。
WebRTCのピアは、分散したクロックで動作する代わりに、自身のタイムスタンプ sendertime1 を含む特別なパケットを送信します。 協力しているピアがそのパケットを受信し、タイムスタンプを送信者に反映します。 オリジナルの送信者は、反映された時間を得ると、現在の時間 sendertime2 からタイムスタンプ sendertime1 を引きます。 この時間差を &ldquo;往復伝搬遅延 &ldquo;といい、より一般的にはラウンドトリップタイムといいます。
rtt = sendertime2 - sendertime1
ラウンド・トリップ・タイムの半分は、送信時間の十分な近似値と考えられます。 この回避策には欠点がないわけではありません。 この方法では、パケットの送信と受信にかかる時間が同じであることを前提としています。 しかし、携帯電話ネットワークでは、送信と受信の動作が時間的に対称でない場合があります。 お使いの携帯電話のアップロード速度は、ほとんどの場合、ダウンロード速度よりも低いことにお気づきかもしれません。
transmission_time = rtt/2
ラウンドトリップタイムの測定に関する技術的な内容は、RTCP送信者と受信者のレポートの章で詳しく説明されています。
ジッター # ジッターとは、「伝送時間」がパケットごとに異なることです。パケットが遅延しても、すぐに到着する可能性があります。
パケットロス # パケットロスとは、メッセージが送信中に失われることです。パケットロスは安定している場合もあれば、急激に発生する場合もあります。 これは、衛星やWi-Fiなどのネットワークの種類に起因します。衛星やWi-Fiなどのネットワークの種類に起因する場合もあれば、通信中のソフトウェアに起因する場合もあります。
最大伝送単位 # 最大伝送容量とは、1つのパケットの大きさの制限のことです。ネットワークでは、1つの巨大なメッセージを送信することはできません。プロトコルレベルでは、メッセージを複数の小さなパケットに分割する必要があるかもしれません。
MTUは、どのようなネットワーク経路をとるかによっても異なります。Path MTU Discoveryのようなプロトコルを使用して、送信可能な最大のパケットサイズを把握できます。
輻輳 (ふくそう) # 輻輳（ふくそう）とは、ネットワークの限界に達した状態のことです。これは通常、現在のルートが処理できる帯域のピークに達したことが原因です。また、ISPが設定した1時間ごとの制限のように、オペレータが課すものもあります。
輻輳は、さまざまな形で現れます。標準的な動作はありません。ほとんどの場合、輻輳状態になると、ネットワークは過剰なパケットをドロップします。他のケースでは、ネットワークはバッファリングします。これにより、パケットの送信時間が長くなります。また、ネットワークが輻輳すると、ジッターが増えることもあります。 この分野は急速に変化しており、輻輳検知のための新しいアルゴリズムはまだ開発中です。
ダイナミック # ネットワークは非常に動的で、状況は急速に変化します。一回の通話では、何十万ものパケットを送受信することがあります。 これらのパケットは、複数のホップを経由します。これらのホップは、何百万人もの他のユーザーによって共有されます。あなたのローカルネットワークでも、HDムービーがダウンロードされたり、デバイスがソフトウェアアップデートをダウンロードしたりすることがあります。"><meta name=theme-color media="(prefers-color-scheme: light)" content="#ffffff"><meta name=theme-color media="(prefers-color-scheme: dark)" content="#343a40"><meta name=color-scheme content="light dark"><meta property="og:url" content="https://webrtcforthecurious.com/ja/docs/05-real-time-networking/"><meta property="og:site_name" content="好奇心旺盛な人のためのWebRTC"><meta property="og:title" content="リアルタイム・ネットワーキング"><meta property="og:description" content="リアルタイム・ネットワーキング # リアルタイム・コミュニケーションにおいて、なぜネットワークが重要なのか？ # ネットワークは、リアルタイム通信を制限する要素です。理想的な世界では、帯域幅が無限にあり、パケットは瞬時に到着します。しかし、実際にはそうではありません。ネットワークには限界があり、いつでも条件が変わる可能性があります。また、ネットワークの状態を測定・観察することも難しい問題です。ハードウェア、ソフトウェア、そしてその構成によって、さまざまな挙動を示すことがあります。
また、リアルタイムでの通信は、他の領域にはない問題です。Web制作者にとっては、ネットワークによってはWebサイトの表示が遅くなっても致命的ではありません。すべてのデータが届いていれば、ユーザーは満足です。WebRTCでは、データが遅れれば意味がありません。5秒前の電話会議の内容なんて誰も気にしません。そのため、リアルタイム通信システムを開発する際には、トレードオフの関係にならざるを得ません。制限時間は何秒か、どれだけ送れるか。
本章では、データ通信とメディア通信の両方に適用される概念を説明します。後の章では、理論的な説明にとどまらず、WebRTCのメディアサブシステムとデータサブシステムがこれらの問題をどのように解決するのかを説明します。
難しくしているネットワークの属性は何ですか？ # すべてのネットワークで効果的に機能するコードは複雑です。多くの異なる要因があり、それらがすべて微妙に影響し合います。開発者が遭遇する最も一般的な問題は以下の通りです。
帯域幅 # 帯域幅とは、特定のパスで転送できるデータの最大レートのことです。これは固定された数値ではないことを覚えておく必要があります。帯域幅は、利用者の増加（または減少）に伴い、経路に沿って変化します。
送信時間とラウンドトリップタイム # 送信時間とは、パケットが到着するまでの時間のことです。帯域幅と同様、これも一定ではありません。 送信時間は、いつでも変動する可能性があります。
伝送時間を計算するには、送信側と受信側の時計がミリ秒単位で同期している必要があります。 少しでもずれがあると、信頼性の低い伝送時間の測定になってしまいます。 WebRTCは非常に異質な環境で運用されているため、ホスト間の完全な時刻同期に頼ることはほとんど不可能です。
ラウンドトリップタイムの測定は、不完全なクロック同期の回避策です。
WebRTCのピアは、分散したクロックで動作する代わりに、自身のタイムスタンプ sendertime1 を含む特別なパケットを送信します。 協力しているピアがそのパケットを受信し、タイムスタンプを送信者に反映します。 オリジナルの送信者は、反映された時間を得ると、現在の時間 sendertime2 からタイムスタンプ sendertime1 を引きます。 この時間差を “往復伝搬遅延 “といい、より一般的にはラウンドトリップタイムといいます。
rtt = sendertime2 - sendertime1
ラウンド・トリップ・タイムの半分は、送信時間の十分な近似値と考えられます。 この回避策には欠点がないわけではありません。 この方法では、パケットの送信と受信にかかる時間が同じであることを前提としています。 しかし、携帯電話ネットワークでは、送信と受信の動作が時間的に対称でない場合があります。 お使いの携帯電話のアップロード速度は、ほとんどの場合、ダウンロード速度よりも低いことにお気づきかもしれません。
transmission_time = rtt/2
ラウンドトリップタイムの測定に関する技術的な内容は、RTCP送信者と受信者のレポートの章で詳しく説明されています。
ジッター # ジッターとは、「伝送時間」がパケットごとに異なることです。パケットが遅延しても、すぐに到着する可能性があります。
パケットロス # パケットロスとは、メッセージが送信中に失われることです。パケットロスは安定している場合もあれば、急激に発生する場合もあります。 これは、衛星やWi-Fiなどのネットワークの種類に起因します。衛星やWi-Fiなどのネットワークの種類に起因する場合もあれば、通信中のソフトウェアに起因する場合もあります。
最大伝送単位 # 最大伝送容量とは、1つのパケットの大きさの制限のことです。ネットワークでは、1つの巨大なメッセージを送信することはできません。プロトコルレベルでは、メッセージを複数の小さなパケットに分割する必要があるかもしれません。
MTUは、どのようなネットワーク経路をとるかによっても異なります。Path MTU Discoveryのようなプロトコルを使用して、送信可能な最大のパケットサイズを把握できます。
輻輳 (ふくそう) # 輻輳（ふくそう）とは、ネットワークの限界に達した状態のことです。これは通常、現在のルートが処理できる帯域のピークに達したことが原因です。また、ISPが設定した1時間ごとの制限のように、オペレータが課すものもあります。
輻輳は、さまざまな形で現れます。標準的な動作はありません。ほとんどの場合、輻輳状態になると、ネットワークは過剰なパケットをドロップします。他のケースでは、ネットワークはバッファリングします。これにより、パケットの送信時間が長くなります。また、ネットワークが輻輳すると、ジッターが増えることもあります。 この分野は急速に変化しており、輻輳検知のための新しいアルゴリズムはまだ開発中です。
ダイナミック # ネットワークは非常に動的で、状況は急速に変化します。一回の通話では、何十万ものパケットを送受信することがあります。 これらのパケットは、複数のホップを経由します。これらのホップは、何百万人もの他のユーザーによって共有されます。あなたのローカルネットワークでも、HDムービーがダウンロードされたり、デバイスがソフトウェアアップデートをダウンロードしたりすることがあります。"><meta property="og:locale" content="ja"><meta property="og:type" content="article"><meta property="article:section" content="docs"><meta property="article:modified_time" content="2022-02-24T14:43:00+08:00"><title>リアルタイム・ネットワーキング | 好奇心旺盛な人のためのWebRTC</title>
<link rel=manifest href=/manifest.json><link rel=icon href=/favicon.png><link rel=canonical href=https://webrtcforthecurious.com/ja/docs/05-real-time-networking/><link rel=alternate hreflang=en href=https://webrtcforthecurious.com/docs/05-real-time-networking/ title="Real-time Networking"><link rel=alternate hreflang=sv href=https://webrtcforthecurious.com/sv/docs/05-real-time-networking/ title=Realtidsnätverk><link rel=alternate hreflang=ru href=https://webrtcforthecurious.com/ru/docs/05-real-time-networking/ title="Сетевое взаимодействие в реальном времени"><link rel=alternate hreflang=zh href=https://webrtcforthecurious.com/zh/docs/05-real-time-networking/ title=搭建实时网络><link rel=alternate hreflang=fa href=https://webrtcforthecurious.com/fa/docs/05-real-time-networking/ title="شبکه بی درنگ"><link rel=alternate hreflang=fr href=https://webrtcforthecurious.com/fr/docs/05-real-time-networking/ title="Real-time Networking"><link rel=alternate hreflang=id href=https://webrtcforthecurious.com/id/docs/05-real-time-networking/ title="Real-time Networking"><link rel=alternate hreflang=es href=https://webrtcforthecurious.com/es/docs/05-real-time-networking/ title="Redes en Tiempo Real"><link rel=alternate hreflang=tr href=https://webrtcforthecurious.com/tr/docs/05-real-time-networking/ title="Gerçek Zamanlı Ağ İletişimi"><link rel=alternate hreflang=ko href=https://webrtcforthecurious.com/ko/docs/05-real-time-networking/ title="실시간 네트워킹"><link rel=stylesheet href=/book.min.309b7ed028807cdb68d8d61e26d609f48369c098dbf5e4d8c0dcf4cdf49feafc.css integrity="sha256-MJt+0CiAfNto2NYeJtYJ9INpwJjb9eTYwNz0zfSf6vw=" crossorigin=anonymous><script defer src=/fuse.min.js></script><script defer src=/ja.search.min.b65272d5bf660afe8aa74038f8c9e7bbfcffaf9f174aa08435c489e245616282.js integrity="sha256-tlJy1b9mCv6Kp0A4+Mnnu/z/r58XSqCENcSJ4kVhYoI=" crossorigin=anonymous></script></head><body dir=ltr><input type=checkbox class="hidden toggle" id=menu-control>
<input type=checkbox class="hidden toggle" id=toc-control><main class="container flex"><aside class=book-menu><div class=book-menu-content><nav><h2 class=book-brand><a class="flex align-center" href=/ja/><span>好奇心旺盛な人のためのWebRTC</span></a></h2><div class="book-search hidden"><input type=text id=book-search-input placeholder=検索 aria-label=検索 maxlength=64 data-hotkeys=s/><div class="book-search-spinner hidden"></div><ul id=book-search-results></ul></div><script>document.querySelector(".book-search").classList.remove("hidden")</script><ul class=book-languages><li><input type=checkbox id=languages class=toggle>
<label for=languages class="flex justify-between"><a role=button class="flex align-center"><img src=/svg/translate.svg class=book-icon alt=Languages>
日本語</a></label><ul><li><a href=https://webrtcforthecurious.com/docs/05-real-time-networking/>English</a></li><li><a href=https://webrtcforthecurious.com/ru/docs/05-real-time-networking/>Русский</a></li><li><a href=https://webrtcforthecurious.com/sv/docs/05-real-time-networking/>Svenska</a></li><li><a href=https://webrtcforthecurious.com/zh/docs/05-real-time-networking/>简体中文</a></li><li><a href=https://webrtcforthecurious.com/fa/docs/05-real-time-networking/>Persian</a></li><li><a href=https://webrtcforthecurious.com/fr/docs/05-real-time-networking/>Français</a></li><li><a href=https://webrtcforthecurious.com/id/docs/05-real-time-networking/>Bahasa Indonesia</a></li><li><a href=https://webrtcforthecurious.com/es/docs/05-real-time-networking/>Español</a></li><li><a href=https://webrtcforthecurious.com/tr/docs/05-real-time-networking/>Türkçe</a></li><li><a href=https://webrtcforthecurious.com/ko/docs/05-real-time-networking/>한국어</a></li></ul></li></ul><ul><li><a href=/ja/docs/01-what-why-and-how/>何を、なぜ、どのように</a></li><li><a href=/ja/docs/02-signaling/>シグナリング</a></li><li><a href=/ja/docs/03-connecting/>接続</a></li><li><a href=/ja/docs/04-securing/>セキュリティ対策</a></li><li><a href=/ja/docs/05-real-time-networking/ class=active>リアルタイム・ネットワーキング</a></li><li><a href=/ja/docs/06-media-communication/>メディア・コミュニケーション</a></li><li><a href=/ja/docs/07-data-communication/>データ・コミュニケーション</a></li><li><a href=/ja/docs/08-applied-webrtc/>応用WebRTC</a></li><li><a href=/ja/docs/09-debugging/>デバッグ</a></li><li><a href=/ja/docs/10-history-of-webrtc/>歴史</a></li><li><a href=/ja/docs/11-faq/>FAQ</a></li><li><a href=/ja/docs/12-glossary/>用語集</a></li><li><a href=/ja/docs/13-reference/>参考文献</a></li></ul></nav><script>(function(){var e=document.querySelector("aside .book-menu-content");addEventListener("beforeunload",function(){localStorage.setItem("menu.scrollTop",e.scrollTop)}),e.scrollTop=localStorage.getItem("menu.scrollTop")})()</script></div></aside><div class=book-page><header class=book-header><div class="flex align-center justify-between"><label for=menu-control><img src=/svg/menu.svg class=book-icon alt=Menu>
</label><strong>リアルタイム・ネットワーキング</strong>
<label for=toc-control><img src=/svg/toc.svg class=book-icon alt="Table of Contents"></label></div><aside class="hidden clearfix"><nav id=TableOfContents><ul><li><a href=#リアルタイムコミュニケーションにおいてなぜネットワークが重要なのか>リアルタイム・コミュニケーションにおいて、なぜネットワークが重要なのか？</a></li><li><a href=#難しくしているネットワークの属性は何ですか>難しくしているネットワークの属性は何ですか？</a><ul><li></li><li><a href=#輻輳-ふくそう>輻輳 (ふくそう)</a></li><li><a href=#ダイナミック>ダイナミック</a></li></ul></li><li><a href=#パケットロスの解決>パケットロスの解決</a><ul><li><a href=#確認応答-acknowledgments>確認応答 (Acknowledgments)</a></li><li><a href=#選択的確認応答-selective-acknowledgments>選択的確認応答 (Selective Acknowledgments)</a></li><li><a href=#否定確認応答-negative-acknowledgments>否定確認応答 (Negative Acknowledgments)</a></li><li><a href=#前方誤り訂正-forward-error-correction>前方誤り訂正 (Forward Error Correction)</a></li></ul></li><li><a href=#ジッターの解決>ジッターの解決</a></li><li><a href=#輻輳の検出>輻輳の検出</a></li><li><a href=#輻輳の解消>輻輳の解消</a><ul><li><a href=#送信速度を遅くする>送信速度を遅くする</a></li><li><a href=#より少ない情報を送る>より少ない情報を送る</a></li></ul></li></ul></nav></aside></header><article class="markdown book-article"><h1 id=リアルタイムネットワーキング>リアルタイム・ネットワーキング
<a class=anchor href=#%e3%83%aa%e3%82%a2%e3%83%ab%e3%82%bf%e3%82%a4%e3%83%a0%e3%83%8d%e3%83%83%e3%83%88%e3%83%af%e3%83%bc%e3%82%ad%e3%83%b3%e3%82%b0>#</a></h1><h2 id=リアルタイムコミュニケーションにおいてなぜネットワークが重要なのか>リアルタイム・コミュニケーションにおいて、なぜネットワークが重要なのか？
<a class=anchor href=#%e3%83%aa%e3%82%a2%e3%83%ab%e3%82%bf%e3%82%a4%e3%83%a0%e3%82%b3%e3%83%9f%e3%83%a5%e3%83%8b%e3%82%b1%e3%83%bc%e3%82%b7%e3%83%a7%e3%83%b3%e3%81%ab%e3%81%8a%e3%81%84%e3%81%a6%e3%81%aa%e3%81%9c%e3%83%8d%e3%83%83%e3%83%88%e3%83%af%e3%83%bc%e3%82%af%e3%81%8c%e9%87%8d%e8%a6%81%e3%81%aa%e3%81%ae%e3%81%8b>#</a></h2><p>ネットワークは、リアルタイム通信を制限する要素です。理想的な世界では、帯域幅が無限にあり、パケットは瞬時に到着します。しかし、実際にはそうではありません。ネットワークには限界があり、いつでも条件が変わる可能性があります。また、ネットワークの状態を測定・観察することも難しい問題です。ハードウェア、ソフトウェア、そしてその構成によって、さまざまな挙動を示すことがあります。</p><p>また、リアルタイムでの通信は、他の領域にはない問題です。Web制作者にとっては、ネットワークによってはWebサイトの表示が遅くなっても致命的ではありません。すべてのデータが届いていれば、ユーザーは満足です。WebRTCでは、データが遅れれば意味がありません。5秒前の電話会議の内容なんて誰も気にしません。そのため、リアルタイム通信システムを開発する際には、トレードオフの関係にならざるを得ません。制限時間は何秒か、どれだけ送れるか。</p><p>本章では、データ通信とメディア通信の両方に適用される概念を説明します。後の章では、理論的な説明にとどまらず、WebRTCのメディアサブシステムとデータサブシステムがこれらの問題をどのように解決するのかを説明します。</p><h2 id=難しくしているネットワークの属性は何ですか>難しくしているネットワークの属性は何ですか？
<a class=anchor href=#%e9%9b%a3%e3%81%97%e3%81%8f%e3%81%97%e3%81%a6%e3%81%84%e3%82%8b%e3%83%8d%e3%83%83%e3%83%88%e3%83%af%e3%83%bc%e3%82%af%e3%81%ae%e5%b1%9e%e6%80%a7%e3%81%af%e4%bd%95%e3%81%a7%e3%81%99%e3%81%8b>#</a></h2><p>すべてのネットワークで効果的に機能するコードは複雑です。多くの異なる要因があり、それらがすべて微妙に影響し合います。開発者が遭遇する最も一般的な問題は以下の通りです。</p><h4 id=帯域幅>帯域幅
<a class=anchor href=#%e5%b8%af%e5%9f%9f%e5%b9%85>#</a></h4><p>帯域幅とは、特定のパスで転送できるデータの最大レートのことです。これは固定された数値ではないことを覚えておく必要があります。帯域幅は、利用者の増加（または減少）に伴い、経路に沿って変化します。</p><h4 id=送信時間とラウンドトリップタイム>送信時間とラウンドトリップタイム
<a class=anchor href=#%e9%80%81%e4%bf%a1%e6%99%82%e9%96%93%e3%81%a8%e3%83%a9%e3%82%a6%e3%83%b3%e3%83%89%e3%83%88%e3%83%aa%e3%83%83%e3%83%97%e3%82%bf%e3%82%a4%e3%83%a0>#</a></h4><p>送信時間とは、パケットが到着するまでの時間のことです。帯域幅と同様、これも一定ではありません。
送信時間は、いつでも変動する可能性があります。</p><p>伝送時間を計算するには、送信側と受信側の時計がミリ秒単位で同期している必要があります。
少しでもずれがあると、信頼性の低い伝送時間の測定になってしまいます。
WebRTCは非常に異質な環境で運用されているため、ホスト間の完全な時刻同期に頼ることはほとんど不可能です。</p><p>ラウンドトリップタイムの測定は、不完全なクロック同期の回避策です。</p><p>WebRTCのピアは、分散したクロックで動作する代わりに、自身のタイムスタンプ <code>sendertime1</code> を含む特別なパケットを送信します。
協力しているピアがそのパケットを受信し、タイムスタンプを送信者に反映します。
オリジナルの送信者は、反映された時間を得ると、現在の時間 <code>sendertime2</code> からタイムスタンプ <code>sendertime1</code> を引きます。
この時間差を &ldquo;往復伝搬遅延 &ldquo;といい、より一般的にはラウンドトリップタイムといいます。</p><p><code>rtt = sendertime2 - sendertime1</code></p><p>ラウンド・トリップ・タイムの半分は、送信時間の十分な近似値と考えられます。
この回避策には欠点がないわけではありません。
この方法では、パケットの送信と受信にかかる時間が同じであることを前提としています。
しかし、携帯電話ネットワークでは、送信と受信の動作が時間的に対称でない場合があります。
お使いの携帯電話のアップロード速度は、ほとんどの場合、ダウンロード速度よりも低いことにお気づきかもしれません。</p><p><code>transmission_time = rtt/2</code></p><p>ラウンドトリップタイムの測定に関する技術的な内容は、<a href=../06-media-communication/#%e5%8f%97%e4%bf%a1%e8%80%85%e3%83%ac%e3%83%9d%e3%83%bc%e3%83%88-receiver-reports>RTCP送信者と受信者のレポートの章</a>で詳しく説明されています。</p><h4 id=ジッター>ジッター
<a class=anchor href=#%e3%82%b8%e3%83%83%e3%82%bf%e3%83%bc>#</a></h4><p>ジッターとは、「伝送時間」がパケットごとに異なることです。パケットが遅延しても、すぐに到着する可能性があります。</p><h4 id=パケットロス>パケットロス
<a class=anchor href=#%e3%83%91%e3%82%b1%e3%83%83%e3%83%88%e3%83%ad%e3%82%b9>#</a></h4><p>パケットロスとは、メッセージが送信中に失われることです。パケットロスは安定している場合もあれば、急激に発生する場合もあります。
これは、衛星やWi-Fiなどのネットワークの種類に起因します。衛星やWi-Fiなどのネットワークの種類に起因する場合もあれば、通信中のソフトウェアに起因する場合もあります。</p><h4 id=最大伝送単位>最大伝送単位
<a class=anchor href=#%e6%9c%80%e5%a4%a7%e4%bc%9d%e9%80%81%e5%8d%98%e4%bd%8d>#</a></h4><p>最大伝送容量とは、1つのパケットの大きさの制限のことです。ネットワークでは、1つの巨大なメッセージを送信することはできません。プロトコルレベルでは、メッセージを複数の小さなパケットに分割する必要があるかもしれません。</p><p>MTUは、どのようなネットワーク経路をとるかによっても異なります。<a href=https://tools.ietf.org/html/rfc1191>Path MTU Discovery</a>のようなプロトコルを使用して、送信可能な最大のパケットサイズを把握できます。</p><h3 id=輻輳-ふくそう>輻輳 (ふくそう)
<a class=anchor href=#%e8%bc%bb%e8%bc%b3-%e3%81%b5%e3%81%8f%e3%81%9d%e3%81%86>#</a></h3><p>輻輳（ふくそう）とは、ネットワークの限界に達した状態のことです。これは通常、現在のルートが処理できる帯域のピークに達したことが原因です。また、ISPが設定した1時間ごとの制限のように、オペレータが課すものもあります。</p><p>輻輳は、さまざまな形で現れます。標準的な動作はありません。ほとんどの場合、輻輳状態になると、ネットワークは過剰なパケットをドロップします。他のケースでは、ネットワークはバッファリングします。これにより、パケットの送信時間が長くなります。また、ネットワークが輻輳すると、ジッターが増えることもあります。
この分野は急速に変化しており、輻輳検知のための新しいアルゴリズムはまだ開発中です。</p><h3 id=ダイナミック>ダイナミック
<a class=anchor href=#%e3%83%80%e3%82%a4%e3%83%8a%e3%83%9f%e3%83%83%e3%82%af>#</a></h3><p>ネットワークは非常に動的で、状況は急速に変化します。一回の通話では、何十万ものパケットを送受信することがあります。
これらのパケットは、複数のホップを経由します。これらのホップは、何百万人もの他のユーザーによって共有されます。あなたのローカルネットワークでも、HDムービーがダウンロードされたり、デバイスがソフトウェアアップデートをダウンロードしたりすることがあります。</p><p>良い通話ができるかどうかは、起動時にネットワークを測定するだけではわかりません。常に評価を行う必要があります。また、様々なネットワークのハードウェアやソフトウェアに起因する、あらゆる異なる動作に対応する必要があります。</p><h2 id=パケットロスの解決>パケットロスの解決
<a class=anchor href=#%e3%83%91%e3%82%b1%e3%83%83%e3%83%88%e3%83%ad%e3%82%b9%e3%81%ae%e8%a7%a3%e6%b1%ba>#</a></h2><p>パケットロスの解決は、最も最初に解決すべき問題です。この問題を解決するには複数の方法があり、それぞれに利点があります。何を送信するのか、どの程度の遅延耐性があるのかによっても異なります。また、すべてのパケットロスが致命的なものではないことにも注意が必要です。ビデオの損失は問題にならないかもしれません、人間の目には認識できないかもしれません。しかし、ユーザーのテキストメッセージが失われることは致命的です。</p><p>例えば、10個のパケットを送信して、5個目と6個目のパケットが失われたとします。この問題を解決する方法は以下の通りです。</p><h3 id=確認応答-acknowledgments>確認応答 (Acknowledgments)
<a class=anchor href=#%e7%a2%ba%e8%aa%8d%e5%bf%9c%e7%ad%94-acknowledgments>#</a></h3><p>確認応答とは、受信者が受信したすべてのパケットを送信者に通知することです。送信者は、最終的ではないパケットに対する確認応答を2回受け取ると、パケットロスを認識します。送信者は、パケット4に対する<code>ACK</code>を2回受け取ると、5がまだ見られていないことがわかります。</p><h3 id=選択的確認応答-selective-acknowledgments>選択的確認応答 (Selective Acknowledgments)
<a class=anchor href=#%e9%81%b8%e6%8a%9e%e7%9a%84%e7%a2%ba%e8%aa%8d%e5%bf%9c%e7%ad%94-selective-acknowledgments>#</a></h3><p>選択的確認応答は、確認応答の改良版です。受信者は、複数のパケットを確認し、ギャップを送信者に通知する<code>SACK</code>を送信できます。
この場合、送信者は4と7に対して<code>SACK</code>を受け取ります。送信者は、5と6を再送する必要があることがわかります。</p><h3 id=否定確認応答-negative-acknowledgments>否定確認応答 (Negative Acknowledgments)
<a class=anchor href=#%e5%90%a6%e5%ae%9a%e7%a2%ba%e8%aa%8d%e5%bf%9c%e7%ad%94-negative-acknowledgments>#</a></h3><p>否定確認応答は、逆の方法で問題を解決します。受信者は、受信した内容を送信者に通知するのではなく、失われた内容を送信者に通知します。今回のケースでは、パケット5とパケット6に対して「NACK」が送信されます。
送信者は、受信者が再送信を希望するパケットだけを知ることができます。</p><h3 id=前方誤り訂正-forward-error-correction>前方誤り訂正 (Forward Error Correction)
<a class=anchor href=#%e5%89%8d%e6%96%b9%e8%aa%a4%e3%82%8a%e8%a8%82%e6%ad%a3-forward-error-correction>#</a></h3><p>前方誤り訂正は、パケットロスを先回りして修正する機能です。送信者は冗長なデータを送信するため、パケットロスがあっても最終的なストリームには影響しません。一般的なアルゴリズムとして
リード・ソロモンエラー訂正があります。</p><p>これにより、アクノリッジの送信と処理のレイテンシーと複雑さが軽減されます。前方誤り訂正は、ネットワークの損失がゼロの場合、帯域幅の無駄になります。</p><h2 id=ジッターの解決>ジッターの解決
<a class=anchor href=#%e3%82%b8%e3%83%83%e3%82%bf%e3%83%bc%e3%81%ae%e8%a7%a3%e6%b1%ba>#</a></h2><p>ジッターはほとんどのネットワークに存在します。LANの中でも、多くの機器が変動するレートでデータを送信しています。<code>ping</code>コマンドで他の機器にpingを打ち、ラウンドトリップレイテンシーの変動に気づくことで、ジッターを簡単に観察できます。</p><p>ジッターを解決するために、クライアントはジッターバッファーを使用します。ジッターバッファーはパケットの配信時間を安定させます。欠点は、ジッターバッファーが早く到着したパケットに若干の遅延を加えることです。
良い点は、遅く到着したパケットがジッターの原因にならないことです。 通話中に以下のようなパケット到着時間があるとします。</p><pre tabindex=0><code>* time=1.46 ms
* time=1.93 ms
* time=1.57 ms
* time=1.55 ms
* time=1.54 ms
* time=1.72 ms
* time=1.45 ms
* time=1.73 ms
* time=1.80 ms
</code></pre><p>この場合は、～1.8msが良いでしょう。遅れて到着したパケットは、レイテンシーのウィンドウを使用します。早く到着したパケットは遅延し、遅く到着したパケットによって減少したウィンドウを埋めることができます。遅れて到着したパケットによって減少したウィンドウを埋めることができます。これにより、スタッタリングがなくなり、クライアントにスムーズな配信速度を提供できます。</p><h2 id=輻輳の検出>輻輳の検出
<a class=anchor href=#%e8%bc%bb%e8%bc%b3%e3%81%ae%e6%a4%9c%e5%87%ba>#</a></h2><p>輻輳を解決する前に、輻輳を検出する必要があります。輻輳を検出するには、輻輳コントローラを使用します。これは複雑なテーマであり、今でも急速に変化しています。
新しいアルゴリズムは今でも発表され、テストされています。高いレベルでは、どれも同じように動作します。輻輳制御装置は、いくつかの入力が与えられると、帯域幅の推定値を提供します。
以下のような入力が考えられます。</p><ul><li><strong>パケットロス</strong> - ネットワークが輻輳するとパケットが廃棄されます。</li><li><strong>ジッター</strong> - ネットワーク機器がより過負荷になると、パケットがキューイングされ、時間が不安定になります。</li><li><strong>ラウンド・トリップ・タイム</strong> - 輻輳するとパケットの到着に時間がかかります。ジッターとは異なり、ラウンド・トリップ・タイムは増加し続けます。</li><li><strong>明示的輻輳通知</strong> - 新しいネットワークでは、輻輳を緩和するためにパケットがドロップされる危険性があるとタグ付けされることがあります。</li></ul><p>これらの値は、通話中に継続して測定する必要があります。ネットワークの利用率は増減するため、利用可能な帯域幅は常に変化します。</p><h2 id=輻輳の解消>輻輳の解消
<a class=anchor href=#%e8%bc%bb%e8%bc%b3%e3%81%ae%e8%a7%a3%e6%b6%88>#</a></h2><p>推定帯域幅がわかったところで、送信するデータを調整する必要があります。どのように調整するかは、どのようなデータを送信するかによって異なります。</p><h3 id=送信速度を遅くする>送信速度を遅くする
<a class=anchor href=#%e9%80%81%e4%bf%a1%e9%80%9f%e5%ba%a6%e3%82%92%e9%81%85%e3%81%8f%e3%81%99%e3%82%8b>#</a></h3><p>データを送る速度を制限することは、輻輳を防ぐための最初の解決策です。輻輳制御装置が推定値を提示し、送信者の責任で速度制限を行います。</p><p>これは、ほとんどのデータ通信で使われている方法です。TCPのようなプロトコルでは、これはすべてオペレーティングシステムによって行われ、ユーザーや開発者にとっては完全に透過的です。</p><h3 id=より少ない情報を送る>より少ない情報を送る
<a class=anchor href=#%e3%82%88%e3%82%8a%e5%b0%91%e3%81%aa%e3%81%84%e6%83%85%e5%a0%b1%e3%82%92%e9%80%81%e3%82%8b>#</a></h3><p>場合によっては、制限値を満たすために、より少ない情報を送ることができます。また、データの到着には期限がありますので、より遅く送ることはできません。このような制約がリアルタイムメディアにはあります。</p><p>十分な帯域が確保できない場合は、送信するビデオの品質を下げることができます。そのためには、ビデオエンコーダーと輻輳制御装置の間で緊密なフィードバックループを構築する必要があります。</p></article><footer class=book-footer><div class="flex flex-wrap justify-between"><div><a class="flex align-center" href=https://github.com/webrtc-for-the-curious/webrtc-for-the-curious/commit/4251664c92082620156c14b31266ff8a3f209a79 title='最終更新者 Pang | 2月 24, 2022' target=_blank rel=noopener><img src=/svg/calendar.svg class=book-icon alt>
<span>2月 24, 2022</span></a></div><div><a class="flex align-center" href=https://github.com/webrtc-for-the-curious/webrtc-for-the-curious/edit/master/content/docs/05-real-time-networking.md target=_blank rel=noopener><img src=/svg/edit.svg class=book-icon alt>
<span>このページを編集する</span></a></div></div><script>(function(){function e(e){const t=window.getSelection(),n=document.createRange();n.selectNodeContents(e),t.removeAllRanges(),t.addRange(n)}document.querySelectorAll("pre code").forEach(t=>{t.addEventListener("click",function(){if(window.getSelection().toString())return;e(t.parentElement),navigator.clipboard&&navigator.clipboard.writeText(t.parentElement.textContent)})})})()</script></footer><div class=book-comments></div><label for=menu-control class="hidden book-menu-overlay"></label></div><aside class=book-toc><div class=book-toc-content><nav id=TableOfContents><ul><li><a href=#リアルタイムコミュニケーションにおいてなぜネットワークが重要なのか>リアルタイム・コミュニケーションにおいて、なぜネットワークが重要なのか？</a></li><li><a href=#難しくしているネットワークの属性は何ですか>難しくしているネットワークの属性は何ですか？</a><ul><li></li><li><a href=#輻輳-ふくそう>輻輳 (ふくそう)</a></li><li><a href=#ダイナミック>ダイナミック</a></li></ul></li><li><a href=#パケットロスの解決>パケットロスの解決</a><ul><li><a href=#確認応答-acknowledgments>確認応答 (Acknowledgments)</a></li><li><a href=#選択的確認応答-selective-acknowledgments>選択的確認応答 (Selective Acknowledgments)</a></li><li><a href=#否定確認応答-negative-acknowledgments>否定確認応答 (Negative Acknowledgments)</a></li><li><a href=#前方誤り訂正-forward-error-correction>前方誤り訂正 (Forward Error Correction)</a></li></ul></li><li><a href=#ジッターの解決>ジッターの解決</a></li><li><a href=#輻輳の検出>輻輳の検出</a></li><li><a href=#輻輳の解消>輻輳の解消</a><ul><li><a href=#送信速度を遅くする>送信速度を遅くする</a></li><li><a href=#より少ない情報を送る>より少ない情報を送る</a></li></ul></li></ul></nav></div></aside></main></body></html>