<!doctype html><html lang=fa dir=rtl><head><meta charset=UTF-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="# امنیت WebRTC چه پروتکل های امنیتی دارد؟ # هر اتصال WebRTC احراز هویت و رمزگذاری شده است. می‌توانید مطمئن باشید که شخص ثالث نمی‌تواند آنچه را که ارسال می‌کنید ببیند یا پیام‌های جعلی درج کند. همچنین می توانید مطمئن باشید که عامل WebRTC که Session Description را ایجاد کرده است، همانی است که شما با آن در ارتباط هستید.
بسیار مهم است که هیچ کس در آن پیام ها دستکاری نکند."><meta name=theme-color media="(prefers-color-scheme: light)" content="#ffffff"><meta name=theme-color media="(prefers-color-scheme: dark)" content="#343a40"><meta name=color-scheme content="light dark"><meta property="og:url" content="https://webrtcforthecurious.com/fa/docs/04-securing/"><meta property="og:site_name" content="WebRTC برای کنجکاوها"><meta property="og:title" content="امنیت"><meta property="og:description" content="# امنیت WebRTC چه پروتکل های امنیتی دارد؟ # هر اتصال WebRTC احراز هویت و رمزگذاری شده است. می‌توانید مطمئن باشید که شخص ثالث نمی‌تواند آنچه را که ارسال می‌کنید ببیند یا پیام‌های جعلی درج کند. همچنین می توانید مطمئن باشید که عامل WebRTC که Session Description را ایجاد کرده است، همانی است که شما با آن در ارتباط هستید.
بسیار مهم است که هیچ کس در آن پیام ها دستکاری نکند."><meta property="og:locale" content="fa"><meta property="og:type" content="article"><meta property="article:section" content="docs"><meta property="article:modified_time" content="2022-02-24T19:51:48+08:00"><title>امنیت | WebRTC برای کنجکاوها</title>
<link rel=manifest href=/manifest.json><link rel=icon href=/favicon.png><link rel=canonical href=https://webrtcforthecurious.com/fa/docs/04-securing/><link rel=alternate hreflang=en href=https://webrtcforthecurious.com/docs/04-securing/ title=Securing><link rel=alternate hreflang=ru href=https://webrtcforthecurious.com/ru/docs/04-securing/ title=Securing><link rel=alternate hreflang=sv href=https://webrtcforthecurious.com/sv/docs/04-securing/ title=Säkerhet><link rel=alternate hreflang=zh href=https://webrtcforthecurious.com/zh/docs/04-securing/ title=安全性><link rel=alternate hreflang=ja href=https://webrtcforthecurious.com/ja/docs/04-securing/ title=セキュリティ対策><link rel=alternate hreflang=fr href=https://webrtcforthecurious.com/fr/docs/04-securing/ title=Securing><link rel=alternate hreflang=id href=https://webrtcforthecurious.com/id/docs/04-securing/ title=Securing><link rel=alternate hreflang=es href=https://webrtcforthecurious.com/es/docs/04-securing/ title=Securing><link rel=alternate hreflang=tr href=https://webrtcforthecurious.com/tr/docs/04-securing/ title=Güvenlik><link rel=alternate hreflang=ko href=https://webrtcforthecurious.com/ko/docs/04-securing/ title=보안><link rel=stylesheet href=/book.min.309b7ed028807cdb68d8d61e26d609f48369c098dbf5e4d8c0dcf4cdf49feafc.css integrity="sha256-MJt+0CiAfNto2NYeJtYJ9INpwJjb9eTYwNz0zfSf6vw=" crossorigin=anonymous><script defer src=/fuse.min.js></script><script defer src=/fa.search.min.8b42327044e674f28b539739f3740e92d53360646e8ec8ea1c5cd8a5df75f52f.js integrity="sha256-i0IycETmdPKLU5c583QOktUzYGRujsjqHFzYpd919S8=" crossorigin=anonymous></script></head><body dir=rtl><input type=checkbox class="hidden toggle" id=menu-control>
<input type=checkbox class="hidden toggle" id=toc-control><main class="container flex"><aside class=book-menu><div class=book-menu-content><nav><h2 class=book-brand><a class="flex align-center" href=/fa/><span>WebRTC برای کنجکاوها</span></a></h2><div class="book-search hidden"><input type=text id=book-search-input placeholder=جستجو aria-label=جستجو maxlength=64 data-hotkeys=s/><div class="book-search-spinner hidden"></div><ul id=book-search-results></ul></div><script>document.querySelector(".book-search").classList.remove("hidden")</script><ul class=book-languages><li><input type=checkbox id=languages class=toggle>
<label for=languages class="flex justify-between"><a role=button class="flex align-center"><img src=/svg/translate.svg class=book-icon alt=Languages>
Persian</a></label><ul><li><a href=https://webrtcforthecurious.com/docs/04-securing/>English</a></li><li><a href=https://webrtcforthecurious.com/ru/docs/04-securing/>Русский</a></li><li><a href=https://webrtcforthecurious.com/sv/docs/04-securing/>Svenska</a></li><li><a href=https://webrtcforthecurious.com/zh/docs/04-securing/>简体中文</a></li><li><a href=https://webrtcforthecurious.com/ja/docs/04-securing/>日本語</a></li><li><a href=https://webrtcforthecurious.com/fr/docs/04-securing/>Français</a></li><li><a href=https://webrtcforthecurious.com/id/docs/04-securing/>Bahasa Indonesia</a></li><li><a href=https://webrtcforthecurious.com/es/docs/04-securing/>Español</a></li><li><a href=https://webrtcforthecurious.com/tr/docs/04-securing/>Türkçe</a></li><li><a href=https://webrtcforthecurious.com/ko/docs/04-securing/>한국어</a></li></ul></li></ul><ul><li><a href=/fa/docs/01-what-why-and-how/>چه چیزی، چرا و چگونه</a></li><li><a href=/fa/docs/02-signaling/>سیگنالینگ</a></li><li><a href=/fa/docs/03-connecting/>اتصال</a></li><li><a href=/fa/docs/04-securing/ class=active>امنیت</a></li><li><a href=/fa/docs/05-real-time-networking/>شبکه بی درنگ</a></li><li><a href=/fa/docs/06-media-communication/>ارتباط رسانه ای</a></li><li><a href=/fa/docs/07-data-communication/>ارتباط داده ای</a></li><li><a href=/fa/docs/08-applied-webrtc/>اعمال کردن WebRTC</a></li><li><a href=/fa/docs/09-debugging/>اشکال زدایی</a></li><li><a href=/fa/docs/11-faq/>پرسش و پاسخ</a></li><li><a href=/fa/docs/12-glossary/>واژه نامه</a></li><li><a href=/fa/docs/13-reference/>Reference</a></li></ul></nav><script>(function(){var e=document.querySelector("aside .book-menu-content");addEventListener("beforeunload",function(){localStorage.setItem("menu.scrollTop",e.scrollTop)}),e.scrollTop=localStorage.getItem("menu.scrollTop")})()</script></div></aside><div class=book-page><header class=book-header><div class="flex align-center justify-between"><label for=menu-control><img src=/svg/menu.svg class=book-icon alt=Menu>
</label><strong>امنیت</strong>
<label for=toc-control><img src=/svg/toc.svg class=book-icon alt="Table of Contents"></label></div><aside class="hidden clearfix"><nav id=TableOfContents><ul><li><a href=#webrtc-چه-پروتکل-های-امنیتی-دارد>WebRTC چه پروتکل های امنیتی دارد؟</a></li><li><a href=#چگونه-کار-می-کند>چگونه کار می کند؟</a></li><li><a href=#امنیت-101>امنیت 101</a><ul><li><a href=#متن-ساده-و-متن-رمزی>متن ساده و متن رمزی</a></li><li><a href=#رمز>رمز</a></li><li><a href=#توابع-هش>توابع هش</a></li><li><a href=#رمزنگاری-کلید-عمومیخصوصی>رمزنگاری کلید عمومی/خصوصی</a></li><li><a href=#تبادل-دیفیهلمن>تبادل دیفی–هلمن</a></li><li><a href=#تابع-شبه-تصادفی>تابع شبه تصادفی</a></li><li><a href=#تابع-مشتق-کلید>تابع مشتق کلید</a></li><li><a href=#هیچ-nonce>هیچ (Nonce)</a></li><li><a href=#کد-احراز-هویت-پیام-mac>کد احراز هویت پیام (MAC)</a></li><li><a href=#چرخش-کلید>چرخش کلید</a></li></ul></li><li><a href=#dtls>DTLS</a><ul><li><a href=#قالب-بسته>قالب بسته</a></li><li><a href=#مکانیسم-حالت-دست-دادن>مکانیسم حالت دست دادن</a></li><li><a href=#نسل-کلید>نسل کلید</a></li><li><a href=#تبادل-داده-های-برنامه>تبادل داده های برنامه</a></li></ul></li><li><a href=#srtp>SRTP</a><ul><li><a href=#ایجاد-جلسه>ایجاد جلسه</a></li><li><a href=#تبادل-رسانه>تبادل رسانه</a></li></ul></li></ul></nav></aside></header><article class="markdown book-article"><div dir=rtl># امنیت<h2 id=webrtc-چه-پروتکل-های-امنیتی-دارد>WebRTC چه پروتکل های امنیتی دارد؟
<a class=anchor href=#webrtc-%da%86%d9%87-%d9%be%d8%b1%d9%88%d8%aa%da%a9%d9%84-%d9%87%d8%a7%db%8c-%d8%a7%d9%85%d9%86%db%8c%d8%aa%db%8c-%d8%af%d8%a7%d8%b1%d8%af>#</a></h2><p>هر اتصال WebRTC احراز هویت و رمزگذاری شده است. می‌توانید مطمئن باشید که شخص ثالث نمی‌تواند آنچه را که ارسال می‌کنید ببیند یا پیام‌های جعلی درج کند. همچنین می توانید مطمئن باشید که عامل WebRTC که Session Description را ایجاد کرده است، همانی است که شما با آن در ارتباط هستید.</p><p>بسیار مهم است که هیچ کس در آن پیام ها دستکاری نکند. اگر شخص ثالثی توضیحات جلسه را در حال انتقال بخواند مشکلی ندارد. با این حال، WebRTC هیچ حفاظتی در برابر تغییر آن ندارد. یک مهاجم می‌تواند با تغییر ICE Candidates و تغییر گواهی اثر انگشت، یک حمله مرد میانی به شما انجام دهد.</p><h2 id=چگونه-کار-می-کند>چگونه کار می کند؟
<a class=anchor href=#%da%86%da%af%d9%88%d9%86%d9%87-%da%a9%d8%a7%d8%b1-%d9%85%db%8c-%da%a9%d9%86%d8%af>#</a></h2><p>WebRTC از دو پروتکل موجود استفاده می‌کند، امنیت لایه انتقال داده‌گرام (<a href=https://tools.ietf.org/html/rfc6347>DTLS</a>) و پروتکل امن حمل و نقل بلادرنگ (<a href=https://tools.ietf.org/html/rfc3711>SRTP</a>).</p><p>DTLS به شما این امکان را می دهد که در یک جلسه مذاکره کنید و سپس داده ها را به صورت امن بین دو همتا مبادله کنید. این پرتکل شبیه TLS است، همان فناوری که HTTPS را تقویت می کند، اما DTLS از UDP به جای TCP به عنوان لایه انتقال استفاده می کند. این بدان معناست که پروتکل باید چیزی را تحویل دهد که قابل اعتماد نیست. SRTP به طور خاص برای تبادل رسانه ایمن طراحی شده است. بهینه سازی هایی وجود دارد که می توانیم با استفاده از آن به جای DTLS انجام دهیم.</p><p>در ابتدا از DTLS استفاده می شود. یک دست دادن(Handshake) بر روی اتصالی که توسط ICE انجام می شد انجام می داد. DTLS یک پروتکل مشتری/سرور است، بنابراین یک طرف باید دست دادن را شروع کند. نقش های کلاینت/سرور در طول سیگنال دهی انتخاب می شوند. در طول دست دادن DTLS، هر دو طرف گواهی ارائه می دهند.
پس از تکمیل دست دادن، این گواهی با هش گواهی در توضیحات جلسه مقایسه می شود. این برای اطمینان از اینکه دست دادن با عامل WebRTC که انتظار داشتید اتفاق افتاده است. سپس اتصال DTLS برای استفاده برای ارتباطات DataChannel در دسترس است.</p><p>برای ایجاد یک جلسه SRTP، آن را با استفاده از کلیدهای تولید شده توسط DTLS مقداردهی اولیه می کنیم. SRTP مکانیزم دست دادن ندارد، بنابراین باید با کلیدهای خارجی مقدار دهی شود. پس از انجام این کار، می توان رسانه ای را که با استفاده از SRTP رمزگذاری شده است، تبادل کرد!</p><h2 id=امنیت-101>امنیت 101
<a class=anchor href=#%d8%a7%d9%85%d9%86%db%8c%d8%aa-101>#</a></h2><p>برای درک فناوری ارائه شده در این فصل، ابتدا باید این اصطلاحات را درک کنید. رمزنگاری موضوع پیچیده ای است، بنابراین ارزش مراجعه به منابع دیگر را نیز دارد!</p><h3 id=متن-ساده-و-متن-رمزی>متن ساده و متن رمزی
<a class=anchor href=#%d9%85%d8%aa%d9%86-%d8%b3%d8%a7%d8%af%d9%87-%d9%88-%d9%85%d8%aa%d9%86-%d8%b1%d9%85%d8%b2%db%8c>#</a></h3><p>متن ساده ورودی یک رمز است. متن رمزی خروجی یک رمز است.</p><h3 id=رمز>رمز
<a class=anchor href=#%d8%b1%d9%85%d8%b2>#</a></h3><p>رمز کردن یک سری مراحل است که متن ساده را به متن رمزی تبدیل می کند. سپس رمز را می توان معکوس کرد، بنابراین می توانید متن رمزی خود را به متن ساده برگردانید. یک رمز معمولا کلیدی برای تغییر رفتار خود دارد. اصطلاح دیگر برای این کار رمزگذاری و رمزگشایی است.</p><p>یک رمز ساده ROT13 است. هر حرف 13 کاراکتر به جلو منتقل می شود. برای خنثی سازی رمز، 13 کاراکتر را به عقب حرکت می دهید. متن ساده <code>HELLO</code> به متن رمزی <code>URYYB</code> تبدیل می‌شود. در این حالت، رمز ROT است و کلید 13 است.</p><h3 id=توابع-هش>توابع هش
<a class=anchor href=#%d8%aa%d9%88%d8%a7%d8%a8%d8%b9-%d9%87%d8%b4>#</a></h3><p>تابع هش یک فرآیند یک طرفه است که یک خلاصه متن تولید می کند. با توجه به یک ورودی، هر بار همان خروجی را تولید می کند. مهم است که خروجی <em>بازگشت</em>پذیر نباشد. اگر خروجی دارید، نباید ورودی آن را تعیین کنید. هش کردن زمانی مفید است که می‌خواهید تأیید کنید پیامی دستکاری نشده است.</p><p>یک تابع هش ساده این است که فقط حروف دیگر را در بگیرد. <code>HELLO</code> به <code>HLO</code> تبدیل می‌شود. نمی‌توانید فرض کنید <code>HELLO</code> ورودی بوده است، اما می‌توانید تأیید کنید که <code>HELLO</code> با خلاصه هش مطابقت دارد.</p><h3 id=رمزنگاری-کلید-عمومیخصوصی>رمزنگاری کلید عمومی/خصوصی
<a class=anchor href=#%d8%b1%d9%85%d8%b2%d9%86%da%af%d8%a7%d8%b1%db%8c-%da%a9%d9%84%db%8c%d8%af-%d8%b9%d9%85%d9%88%d9%85%db%8c%d8%ae%d8%b5%d9%88%d8%b5%db%8c>#</a></h3><p>رمزنگاری کلید عمومی/خصوصی نوع رمزهایی را که DTLS و SRTP استفاده می‌کنند. در این سیستم شما دو کلید عمومی و خصوصی دارید. کلید عمومی برای رمزگذاری پیام ها است و به اشتراک گذاری امن است.
کلید خصوصی برای رمزگشایی است و هرگز نباید به اشتراک گذاشته شود. این تنها کلیدی است که می تواند پیام های رمزگذاری شده با کلید عمومی را رمزگشایی کند.</p><h3 id=تبادل-دیفیهلمن>تبادل دیفی–هلمن
<a class=anchor href=#%d8%aa%d8%a8%d8%a7%d8%af%d9%84-%d8%af%db%8c%d9%81%db%8c%d9%87%d9%84%d9%85%d9%86>#</a></h3><p>تبادل Diffie–Hellman به دو کاربر که قبلا هرگز ملاقات نکرده‌اند اجازه می‌دهد تا یک رمز مشترک را به صورت ایمن از طریق اینترنت ایجاد کنند. کاربر <code>A</code> می تواند بدون نگرانی در مورد استراق سمع، یک رمز را برای کاربر <code>B</code> ارسال کند. پیچیدگی رمزنگاری به دشواری شکستن مسئله لگاریتم گسسته بستگی دارد.
شما نیازی به درک کامل نحوه عملکرد این کار ندارید، اما دانستن اینکه این چیزی است که به دست دادن DTLS را ممکن می‌کند.</p><p>ویکی‌پدیا نمونه‌ای از این را در عمل دارد <a href=https://en.wikipedia.org/wiki/Diffie%E2%80%93Hellman_key_exchange#Cryptographic_explanation>اینجا</a>.</p><h3 id=تابع-شبه-تصادفی>تابع شبه تصادفی
<a class=anchor href=#%d8%aa%d8%a7%d8%a8%d8%b9-%d8%b4%d8%a8%d9%87-%d8%aa%d8%b5%d8%a7%d8%af%d9%81%db%8c>#</a></h3><p>یک تابع شبه تصادفی (PRF) یک تابع از پیش تعریف شده برای تولید مقداری است که تصادفی به نظر می رسد. ممکن است چندین ورودی بگیرد و یک خروجی تولید کند.</p><h3 id=تابع-مشتق-کلید>تابع مشتق کلید
<a class=anchor href=#%d8%aa%d8%a7%d8%a8%d8%b9-%d9%85%d8%b4%d8%aa%d9%82-%da%a9%d9%84%db%8c%d8%af>#</a></h3><p>مشتق کلید نوعی تابع شبه تصادفی است. مشتق کلید تابعی است که برای قوی‌تر کردن کلید استفاده می‌شود. یکی از الگوهای رایج طولانی کردن کلید است.</p><p>فرض کنید یک کلید به شما داده شده است که 8 بایت است. می توانید از KDF برای قوی تر کردن آن استفاده کنید.</p><h3 id=هیچ-nonce>هیچ (Nonce)
<a class=anchor href=#%d9%87%db%8c%da%86-nonce>#</a></h3><p>یک nonce یک ورودی اضافی به یک رمز است. این مورد استفاده قرار می گیرد تا بتوانید خروجی های متفاوتی از رمز دریافت کنید، حتی اگرشما یک پیام را چندین بار رمزگذاری می کنید.</p><p>اگر یک پیام را 10 بار رمزگذاری کنید، رمزگذار همان متن رمزی را 10 بار به شما می دهد. با استفاده از یک nonce می‌توانید خروجی‌های متفاوتی دریافت کنید، در حالی که همچنان از یک کلید استفاده می‌کنید. مهم است که برای هر پیام از یک nonce متفاوت استفاده کنید! در غیر این صورت، مقدار زیادی از ارزش را نفی می کند.</p><h3 id=کد-احراز-هویت-پیام-mac>کد احراز هویت پیام (MAC)
<a class=anchor href=#%da%a9%d8%af-%d8%a7%d8%ad%d8%b1%d8%a7%d8%b2-%d9%87%d9%88%db%8c%d8%aa-%d9%be%db%8c%d8%a7%d9%85-mac>#</a></h3><p>کد احراز هویت پیام، همان هش است که در انتهای پیام قرار می گیرد. MAC ثابت می کند که پیام از طرف کاربری که انتظار داشتید می آید.</p><p>اگر از MAC استفاده نمی کنید، مهاجم می تواند پیام های نامعتبری را وارد کند. پس از رمزگشایی شما فقط زباله خواهید داشت زیرا آنها کلید را نمی دانند.</p><h3 id=چرخش-کلید>چرخش کلید
<a class=anchor href=#%da%86%d8%b1%d8%ae%d8%b4-%da%a9%d9%84%db%8c%d8%af>#</a></h3><p>چرخش کلید، تغییر کلید در یک بازه زمانی مشخص است. این باعث می شود کلید دزدیده شده تاثیر کمتری داشته باشد. اگر یک کلید به سرقت رفته یا فاش شود، داده های کمتری را می توان رمزگشایی کرد.</p><h2 id=dtls>DTLS
<a class=anchor href=#dtls>#</a></h2><p>DTLS (امنیت لایه انتقال داده ها) به دو همتا اجازه می دهد تا ارتباط ایمن را بدون پیکربندی قبلی برقرار کنند. حتی اگر کسی مکالمه را استراق سمع کند، نمی تواند پیام ها را رمزگشایی کند.</p><p>برای ارتباط یک کلاینت DTLS و یک سرور، باید روی رمز و کلید به توافق برسند. آنها این مقادیر را با انجام یک دست دادن DTLS تعیین می کنند. در حین دست دادن، پیام ها به صورت متن ساده هستند.
هنگامی که یک سرویس گیرنده/سرور DTLS جزئیات کافی را برای شروع رمزگذاری رد و بدل می کند، <code>تغییر مشخصات رمز(Change Cipher Spec)</code> را ارسال می کند. پس از این پیام، هر پیام بعدی رمزگذاری می شود!</p><h3 id=قالب-بسته>قالب بسته
<a class=anchor href=#%d9%82%d8%a7%d9%84%d8%a8-%d8%a8%d8%b3%d8%aa%d9%87>#</a></h3><p>هر بسته DTLS با یک هدر شروع می شود.</p><h4 id=نوع-محتوا>نوع محتوا
<a class=anchor href=#%d9%86%d9%88%d8%b9-%d9%85%d8%ad%d8%aa%d9%88%d8%a7>#</a></h4><p>شما می توانید نوع های زیر را انتظار داشته باشید:</p><ul><li><code>20</code> - تغییر مشخصات رمز</li><li><code>22</code> - دست دادن</li><li><code>23</code> - داده های برنامه</li></ul><p><code>Handshake</code> برای تبادل جزئیات برای شروع جلسه استفاده می شود. از <code>تغییر مشخصات رمز</code> برای اطلاع دادن به طرف مقابل استفاده می‌شود که همه چیز رمزگذاری خواهد شد. <code>Application Data</code> پیام های رمزگذاری شده هستند.</p><h4 id=نسخه>نسخه
<a class=anchor href=#%d9%86%d8%b3%d8%ae%d9%87>#</a></h4><p>نسخه می تواند <code>0x0000feff</code> (DTLS v1.0) یا <code>0x0000fefd</code> (DTLS v1.2) باشد، نسخه 1.1 وجود ندارد.</p><p>####Epoch
Epoch از <code>0</code> شروع می‌شود، اما پس از <code>تغییر مشخصات رمز</code> به <code>1</code> تبدیل می‌شود. هر پیامی با Epoch غیر صفر رمزگذاری شده است.</p><h4 id=شماره-ترتیب>شماره ترتیب
<a class=anchor href=#%d8%b4%d9%85%d8%a7%d8%b1%d9%87-%d8%aa%d8%b1%d8%aa%db%8c%d8%a8>#</a></h4><p>Sequence Number برای مرتب نگه داشتن پیام ها استفاده می شود. هر پیام تعداد توالی را افزایش می دهد. هنگامی که دوره افزایش می یابد، شماره توالی دوباره شروع می شود.</p><h4 id=طول-و-بار>طول و بار
<a class=anchor href=#%d8%b7%d9%88%d9%84-%d9%88-%d8%a8%d8%a7%d8%b1>#</a></h4><p>Payload <code>نوع محتوا</code> خاص است. برای هر <code>داده های برنامه</code>، <code>Payload</code> رمزگذاری شده است. برای <code>Handshake</code> بسته به پیام متفاوت خواهد بود. طول به میزان بزرگی <code>بار محموله</code> است.</p><h3 id=مکانیسم-حالت-دست-دادن>مکانیسم حالت دست دادن
<a class=anchor href=#%d9%85%da%a9%d8%a7%d9%86%db%8c%d8%b3%d9%85-%d8%ad%d8%a7%d9%84%d8%aa-%d8%af%d8%b3%d8%aa-%d8%af%d8%a7%d8%af%d9%86>#</a></h3><p>در حین دست دادن، مشتری/سرور یک سری پیام را مبادله می کند. این پیام ها در دسته هایی گروه بندی می شوند. هر دسته ممکن است چندین پیام در خود داشته باشد (یا فقط یک).
یک دسته تا زمانی که تمام پیام‌های موجود در دسته دریافت نشده باشد کامل نمی‌شود. در زیر هدف هر پیام را با جزئیات بیشتر شرح خواهیم داد.</p><p>![دست دادن](../images/04-handshake.png <code>دست دادن</code>)</p><p>####ClientHello
ClientHello پیام اولیه ارسال شده توسط مشتری است. این شامل لیستی از ویژگی ها است. این ویژگی ها رمزها و ویژگی هایی را که مشتری پشتیبانی می کند را به سرور می گوید. برای WebRTC به این صورت است که رمز SRTP را نیز انتخاب می کنیم. همچنین حاوی داده های تصادفی است که برای تولید کلیدهای جلسه استفاده می شود.</p><h4 id=helloverifyrequest>HelloVerifyRequest
<a class=anchor href=#helloverifyrequest>#</a></h4><p>HelloVerifyRequest توسط سرور برای مشتری ارسال می شود. برای اطمینان از اینکه مشتری قصد ارسال درخواست را داشته است. سپس کلاینت ClientHello را مجدداً ارسال می کند، اما با یک توکن ارائه شده در HelloVerifyRequest.</p><p>####ServerHello
ServerHello پاسخ سرور برای پیکربندی این جلسه است. این شامل رمزی است که پس از پایان این جلسه استفاده می شود. همچنین حاوی داده های تصادفی سرور است.</p><h4 id=گواهی>گواهی
<a class=anchor href=#%da%af%d9%88%d8%a7%d9%87%db%8c>#</a></h4><p>گواهی شامل Certificate برای مشتری یا سرور است. از این برای شناسایی منحصر به فرد افرادی که با آنها در ارتباط بودیم استفاده می شود. پس از پایان دست دادن، مطمئن می شویم که این گواهی زمانی که هش می شود با اثر انگشت در <code>Description Session</code> مطابقت داشته باشد.</p><h4 id=serverkeyexchangeclientkeyexchange>ServerKeyExchange/ClientKeyExchange
<a class=anchor href=#serverkeyexchangeclientkeyexchange>#</a></h4><p>این پیام ها برای انتقال کلید عمومی استفاده می شود. هنگام راه اندازی، مشتری و سرور هر دو یک جفت کلید ایجاد می کنند. پس از دست دادن، از این مقادیر برای ایجاد <code>Pre-Master Secret</code> استفاده می شود.</p><p>####CertificateRequest
یک CertificateRequest توسط سرور ارسال می شود و به مشتری اطلاع می دهد که گواهی می خواهد. سرور می تواند درخواست یا نیاز به گواهی داشته باشد.</p><p>####ServerHelloDone
ServerHelloDone به مشتری اطلاع می دهد که کار سرور با دست دادن تمام شده است.</p><p>####CertificateVerify
CertificateVerify روشی است که فرستنده ثابت می کند که کلید خصوصی ارسال شده در پیام Certificate را دارد.</p><h4 id=changecipherspec>ChangeCipherSpec
<a class=anchor href=#changecipherspec>#</a></h4><p>ChangeCipherSpec به گیرنده اطلاع می دهد که هر چیزی که پس از این پیام ارسال می شود رمزگذاری خواهد شد.</p><p>####Finished
Finished رمزگذاری شده است و حاوی هش از همه پیام‌ها است. این برای اثبات این است که دست دادن دستکاری نشده است.</p><h3 id=نسل-کلید>نسل کلید
<a class=anchor href=#%d9%86%d8%b3%d9%84-%da%a9%d9%84%db%8c%d8%af>#</a></h3><p>پس از اتمام Handshake، می توانید شروع به ارسال داده های رمزگذاری شده کنید. رمز توسط سرور انتخاب شده و در ServerHello قرار دارد. چگونه این کلید انتخاب می شود؟</p><p>ابتدا <code>Pre-Master Secret</code> را تولید می کنیم. برای به دست آوردن این مقدار، Diffie–Hellman روی کلیدهای مبادله شده توسط <code>ServerKeyExchange</code> و <code>ClientKeyExchange</code> استفاده می شود. جزئیات بسته به رمز انتخابی، متفاوت است.</p><p>سپس <code>Master Secret</code> تولید می شود. هر نسخه از DTLS یک <code>Pseudorandom function</code> تعریف شده دارد. برای DTLS 1.2 این تابع مقادیر <code>Pre-Master Secret</code> و مقادیر تصادفی را در <code>ClientHello</code> و <code>ServerHello</code> می گیرد.
خروجی اجرای <code>Pseudorandom function</code> <code>Master Secret</code> است. <code>Master Secret</code> مقداری است که برای رمز استفاده می شود.</p><h3 id=تبادل-داده-های-برنامه>تبادل داده های برنامه
<a class=anchor href=#%d8%aa%d8%a8%d8%a7%d8%af%d9%84-%d8%af%d8%a7%d8%af%d9%87-%d9%87%d8%a7%db%8c-%d8%a8%d8%b1%d9%86%d8%a7%d9%85%d9%87>#</a></h3><p>نقطه قوت DTLS چیزی جز <code>ApplicationData</code> نیست. اکنون که یک رمز اولیه داریم، می توانیم رمزگذاری و ارسال مقادیر را شروع کنیم.</p><p>پیام‌های <code>ApplicationData</code> از هدر DTLS همانطور که قبلاً توضیح داده شد استفاده می‌کنند. <code>Payload</code> با متن رمز پر شده است. شما اکنون یک جلسه DTLS در حال کار دارید و می توانید به طور ایمن ارتباط برقرار کنید.</p><p>DTLS دارای بسیاری از ویژگی های جالب دیگر مانند مذاکره مجدد است. آنها توسط WebRTC استفاده نمی شوند، بنابراین در اینجا پوشش داده نمی شوند.</p><h2 id=srtp>SRTP
<a class=anchor href=#srtp>#</a></h2><p>SRTP یک پروتکل است که به طور خاص برای رمزگذاری بسته های RTP طراحی شده است. برای شروع یک جلسه SRTP، کلیدها و رمز خود را مشخص می کنید. برخلاف DTLS مکانیسم دست دادن ندارد. تمام تنظیمات و کلیدها در حین دست دادن DTLS ایجاد شدند.</p><p>DTLS یک API اختصاصی برای صادر کردن کلیدها برای استفاده در فرآیند دیگری فراهم می کند که در <a href=https://tools.ietf.org/html/rfc5705>RFC 5705</a> تعریف شده است.</p><h3 id=ایجاد-جلسه>ایجاد جلسه
<a class=anchor href=#%d8%a7%db%8c%d8%ac%d8%a7%d8%af-%d8%ac%d9%84%d8%b3%d9%87>#</a></h3><p>SRTP یک تابع مشتق کلیدی را تعریف می کند که در ورودی ها استفاده می شود. هنگام ایجاد یک جلسه SRTP، ورودی ها از طریق آن اجرا می شوند تا کلیدهای ما را برای رمز SRTP تولید کنند. پس از این می توانید به پردازش رسانه بروید.</p><h3 id=تبادل-رسانه>تبادل رسانه
<a class=anchor href=#%d8%aa%d8%a8%d8%a7%d8%af%d9%84-%d8%b1%d8%b3%d8%a7%d9%86%d9%87>#</a></h3><p>هر بسته RTP یک SequenceNumber 16 بیتی دارد. این اعداد ترتیبی برای مرتب نگه داشتن بسته ها مانند کلید اصلی استفاده می شود. در طول یک تماس، اینها جابجا می شوند. SRTP آن را ردیابی می کند و آن را rollover counter می نامد.</p><p>هنگام رمزگذاری یک بسته، SRTP از شمارنده rollover و شماره دنباله به عنوان nonce استفاده می کند. این برای اطمینان از این است که حتی اگر یک داده را دو بار ارسال کنید، متن رمز متفاوت خواهد بود. این برای جلوگیری از شناسایی الگوها یا تلاش برای حمله مجدد توسط مهاجم مهم است.</p></div></article><footer class=book-footer><div class="flex flex-wrap justify-between"><div><a class="flex align-center" href=https://github.com/webrtc-for-the-curious/webrtc-for-the-curious/commit/4106247124e69adde33201040121d636951d6675 title='آخرین بار ویرایش شده توسط Pang | فوریهٔ 24, 2022' target=_blank rel=noopener><img src=/svg/calendar.svg class=book-icon alt>
<span>فوریهٔ 24, 2022</span></a></div><div><a class="flex align-center" href=https://github.com/webrtc-for-the-curious/webrtc-for-the-curious/edit/master/content/docs/04-securing.md target=_blank rel=noopener><img src=/svg/edit.svg class=book-icon alt>
<span>این صفحه را ویرایش کنید</span></a></div></div><script>(function(){function e(e){const t=window.getSelection(),n=document.createRange();n.selectNodeContents(e),t.removeAllRanges(),t.addRange(n)}document.querySelectorAll("pre code").forEach(t=>{t.addEventListener("click",function(){if(window.getSelection().toString())return;e(t.parentElement),navigator.clipboard&&navigator.clipboard.writeText(t.parentElement.textContent)})})})()</script></footer><div class=book-comments></div><label for=menu-control class="hidden book-menu-overlay"></label></div><aside class=book-toc><div class=book-toc-content><nav id=TableOfContents><ul><li><a href=#webrtc-چه-پروتکل-های-امنیتی-دارد>WebRTC چه پروتکل های امنیتی دارد؟</a></li><li><a href=#چگونه-کار-می-کند>چگونه کار می کند؟</a></li><li><a href=#امنیت-101>امنیت 101</a><ul><li><a href=#متن-ساده-و-متن-رمزی>متن ساده و متن رمزی</a></li><li><a href=#رمز>رمز</a></li><li><a href=#توابع-هش>توابع هش</a></li><li><a href=#رمزنگاری-کلید-عمومیخصوصی>رمزنگاری کلید عمومی/خصوصی</a></li><li><a href=#تبادل-دیفیهلمن>تبادل دیفی–هلمن</a></li><li><a href=#تابع-شبه-تصادفی>تابع شبه تصادفی</a></li><li><a href=#تابع-مشتق-کلید>تابع مشتق کلید</a></li><li><a href=#هیچ-nonce>هیچ (Nonce)</a></li><li><a href=#کد-احراز-هویت-پیام-mac>کد احراز هویت پیام (MAC)</a></li><li><a href=#چرخش-کلید>چرخش کلید</a></li></ul></li><li><a href=#dtls>DTLS</a><ul><li><a href=#قالب-بسته>قالب بسته</a></li><li><a href=#مکانیسم-حالت-دست-دادن>مکانیسم حالت دست دادن</a></li><li><a href=#نسل-کلید>نسل کلید</a></li><li><a href=#تبادل-داده-های-برنامه>تبادل داده های برنامه</a></li></ul></li><li><a href=#srtp>SRTP</a><ul><li><a href=#ایجاد-جلسه>ایجاد جلسه</a></li><li><a href=#تبادل-رسانه>تبادل رسانه</a></li></ul></li></ul></nav></div></aside></main></body></html>